<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>toune-o-matic</title>

  <link rel="stylesheet" href="assets/css/app.css" />
  <script defer src="assets/js/app.js"></script>
</head>

<body>
  <header>
    <h1>toune-o-matic</h1>
    <small class="tag">UI locale – contrôle MPD + Snapcast</small>
  </header>

  <div class="row">
    <!-- Connexion / API -->
    <section class="card">
      <h2>Connexion</h2>
      <div class="grid2">
        <div>
          <label class="tag" for="apiKey">Clé API</label>
          <input id="apiKey" type="password" placeholder="(facultatif)" autocomplete="off" />
        </div>
        <div>
          <label class="tag" for="browse_path">Chemin (browse)</label>
          <input id="browse_path" class="mono" type="text" value="" placeholder="" />
        </div>
      </div>

      <div class="btns">
        <button class="primary" onclick="saveKey(true)">Sauver</button>
        <button class="ghost" onclick="clearKey()">Effacer</button>
        <button onclick="refreshAll()">Rafraîchir</button>
        <button onclick="getText('/api/health','out_health', false)">Health</button>
      </div>

      <div class="btns">
        <label class="pill">
          <input id="autoPlay" type="checkbox" />
          <span>Auto-play</span>
        </label>

        <span class="pill"><span id="dot_play" class="dot"></span> Lecture</span>
        <span class="pill"><span id="dot_dac" class="dot"></span> DAC</span>
        <span class="pill"><span id="dot_snap" class="dot"></span> Snapcast</span>
      </div>

      <pre id="out_health" class="mono" aria-label="Sortie health"></pre>
      <pre id="out_status" class="mono" aria-label="Sortie status"></pre>
    </section>

    <!-- Lecture -->
    <section class="card">
      <h2>Lecture</h2>

      <div class="btns">
        <button onclick="cmd('toggle')">⏯︎ Toggle</button>
        <button onclick="cmd('pause')">⏸︎ Pause</button>
        <button onclick="cmd('resume')">▶︎ Play</button>
        <button onclick="cmd('prev')">⏮︎ Préc</button>
        <button onclick="cmd('next')">⏭︎ Suiv</button>
        <button class="danger" onclick="cmd('stop')">⏹︎ Stop</button>
      </div>

      <div class="btns">
        <button class="ghost" onclick="setMode('dac')">DAC</button>
        <button class="ghost" onclick="setMode('snap')">Snap</button>
        <button class="ghost" onclick="setMode('both')">Both</button>
      </div>

      <div style="margin-top:12px">
        <div class="tag">Now playing</div>
        <div id="np_title" style="font-size:18px;font-weight:700;margin:6px 0">—</div>
        <div id="np_artist_album" class="tag">—</div>

        <div class="kv" style="margin-top:10px">
          <span class="pill">Écoulé: <span id="np_elapsed" class="mono">0:00</span></span>
          <span class="pill">Durée: <span id="np_duration" class="mono">0:00</span></span>
          <span class="pill">État: <span id="np_state" class="mono">—</span></span>
          <span class="pill">Volume: <span id="np_volume" class="mono">—</span></span>
        </div>

        <div class="bar" style="margin-top:10px">
          <div id="np_prog" class="barfill" style="width:0%"></div>
        </div>
      </div>
    </section>
  </div>

  <div class="row">
    <!-- Queue -->
    <section class="card">
      <h2>Queue</h2>
      <div class="btns">
        <button onclick="getQueue()">Rafraîchir</button>
        <button onclick="queuePlay(0)">▶︎ Play #0</button>
        <button class="danger" onclick="postJson('/api/queue/clear', {}, 'out_queue', () => getQueue())">Vider</button>
      </div>
      <pre id="out_queue" class="mono" aria-label="Sortie queue"></pre>
    </section>

    <!-- Browse -->
    <section class="card">
      <h2>Browse</h2>
      <div class="btns">
        <button onclick="browseGo('')">Racine</button>
        <button onclick="browseUp()">⬆︎ Up</button>
        <button onclick="browseGo(document.getElementById('browse_path').value)">Go</button>
        <button onclick="browseReload()">Reload</button>
      </div>

      <div id="browse_list" class="list" aria-label="Liste browse"></div>
      <pre id="out_browse" class="mono" aria-label="Sortie browse"></pre>
    </section>
  </div>
</body>
</html>